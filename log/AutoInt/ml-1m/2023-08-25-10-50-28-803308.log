[2023-08-25 10:50:28] INFO Log saved in /root/autodl-tmp/xingmei/RecStudio/log/AutoInt/ml-1m/2023-08-25-10-50-28-803308.log.
[2023-08-25 10:50:28] INFO Global seed set to 2022
[2023-08-25 10:50:28] INFO dataset is read from ./.recstudio/ml-1m.
[2023-08-25 10:50:35] INFO 
Dataset Info: 

=============================================================================
interaction information: 
field      UserID     MovieID    Rating     Timestamp  
type       token      token      float      float      
##         6041       3417       -          -          
=============================================================================
user information: 
field      UserID     Gender     Age        Occupation Zip-code   
type       token      token      token      token      token      
##         6041       3          8          22         3440       
=============================================================================
item information: 
field      MovieID    Title      Genres     
type       token      token_seq  token_seq  
##         3417       4702       19         
=============================================================================
Total Interactions: 999611
Sparsity: 0.951552
=============================================================================

[2023-08-25 10:50:35] INFO 
Model Config: 

data:
	binarized_rating_thres=3.0
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user_entry
	split_ratio=[0.8, 0.1, 0.1]
	fmeval=True
	low_rating_thres=0.0
eval:
	batch_size=128
	cutoff=[5, 10, 20]
	val_metrics=['auc', 'logloss']
	val_n_epoch=1
	test_metrics=['auc', 'logloss']
	topk=100
	save_path=./saved/
model:
	embed_dim=10
	item_bias=False
	wide=False
	deep=False
	mlp_layer=[128, 64]
	activation=relu
	dropout=0.5
	attention_dim=10
	num_attention_layers=4
	n_head=2
	residual=True
	residual_project=True
	layer_norm=False
train:
	accelerator=gpu
	ann=None
	batch_size=512
	early_stop_mode=max
	early_stop_patience=10
	epochs=1000
	gpu=1
	grad_clip_norm=None
	init_method=xavier_normal
	item_batch_size=1024
	learner=adam
	learning_rate=0.001
	num_threads=10
	sampling_method=none
	sampler=uniform
	negative_count=0
	excluding_hist=False
	scheduler=None
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
[2023-08-25 10:50:35] INFO Tensorboard log saved in ./tensorboard/AutoInt/ml-1m/2023-08-25-10-50-28-803308.
[2023-08-25 10:50:35] WARNING If you want to use all fields, the float fields might need a scaler. This can be set in dataset.yaml
[2023-08-25 10:50:35] WARNING No retriever is used, topk metrics is not supported.
[2023-08-25 10:50:35] INFO save_dir:./saved/
[2023-08-25 10:50:35] INFO AutoInt(
  (loss_fn): BCEWithLogitLoss()
  (embedding): Embeddings(
    num_features=9, embed_dim=10, reduction=mean
    (embeddings): ModuleDict(
      (Gender): Embedding(3, 10, padding_idx=0)
      (Genres): Embedding(19, 10, padding_idx=0)
      (Zip-code): Embedding(3440, 10, padding_idx=0)
      (UserID): Embedding(6041, 10, padding_idx=0)
      (MovieID): Embedding(3417, 10, padding_idx=0)
      (Timestamp): DenseEmbedding(
        embedding_dim=10, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=10, bias=False)
      )
      (Title): Embedding(4702, 10, padding_idx=0)
      (Age): Embedding(8, 10, padding_idx=0)
      (Occupation): Embedding(22, 10, padding_idx=0)
    )
    (seq_pooling_layer): SeqPoolingLayer(pooling_type=mean, keepdim=False)
  )
  (int): Sequential(
    (0): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=2, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
    (1): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=2, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
    (2): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=2, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
    (3): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=2, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
  )
  (fc): Linear(in_features=90, out_features=1, bias=True)
)
[2023-08-25 10:51:28] INFO Training: Epoch=  0 [logloss=0.3403 auc=0.8254 train_loss_0=0.3662]
[2023-08-25 10:51:28] INFO Train time: 47.59055s. Valid time: 4.33653s. GPU RAM: 0.03/39.39 GB
[2023-08-25 10:51:28] INFO auc improved. Best value: 0.8254
[2023-08-25 10:51:28] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:52:19] INFO Training: Epoch=  1 [logloss=0.3369 auc=0.8292 train_loss_0=0.3363]
[2023-08-25 10:52:19] INFO Train time: 44.85513s. Valid time: 5.69267s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:52:19] INFO auc improved. Best value: 0.8292
[2023-08-25 10:52:19] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:53:08] INFO Training: Epoch=  2 [logloss=0.3338 auc=0.8344 train_loss_0=0.3307]
[2023-08-25 10:53:08] INFO Train time: 41.51312s. Valid time: 7.29426s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:53:08] INFO auc improved. Best value: 0.8344
[2023-08-25 10:53:08] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:53:55] INFO Training: Epoch=  3 [logloss=0.3320 auc=0.8366 train_loss_0=0.3253]
[2023-08-25 10:53:56] INFO Train time: 41.27909s. Valid time: 6.17008s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:53:56] INFO auc improved. Best value: 0.8366
[2023-08-25 10:53:56] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:54:44] INFO Training: Epoch=  4 [logloss=0.3302 auc=0.8385 train_loss_0=0.3214]
[2023-08-25 10:54:44] INFO Train time: 41.68597s. Valid time: 6.55032s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:54:44] INFO auc improved. Best value: 0.8385
[2023-08-25 10:54:44] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:55:32] INFO Training: Epoch=  5 [logloss=0.3292 auc=0.8409 train_loss_0=0.3181]
[2023-08-25 10:55:32] INFO Train time: 41.19665s. Valid time: 7.21173s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:55:32] INFO auc improved. Best value: 0.8409
[2023-08-25 10:55:32] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:56:19] INFO Training: Epoch=  6 [logloss=0.3301 auc=0.8422 train_loss_0=0.3148]
[2023-08-25 10:56:20] INFO Train time: 41.80444s. Valid time: 5.45191s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:56:20] INFO auc improved. Best value: 0.8422
[2023-08-25 10:56:20] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:57:06] INFO Training: Epoch=  7 [logloss=0.3297 auc=0.8427 train_loss_0=0.3117]
[2023-08-25 10:57:06] INFO Train time: 40.83154s. Valid time: 5.55745s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:57:06] INFO auc improved. Best value: 0.8427
[2023-08-25 10:57:06] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:57:51] INFO Training: Epoch=  8 [logloss=0.3275 auc=0.8435 train_loss_0=0.3093]
[2023-08-25 10:57:52] INFO Train time: 40.40392s. Valid time: 5.04151s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:57:52] INFO auc improved. Best value: 0.8435
[2023-08-25 10:57:52] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:58:39] INFO Training: Epoch=  9 [logloss=0.3282 auc=0.8435 train_loss_0=0.3075]
[2023-08-25 10:58:39] INFO Train time: 41.57374s. Valid time: 5.31062s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:58:39] INFO auc improved. Best value: 0.8435
[2023-08-25 10:58:39] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 10:59:26] INFO Training: Epoch= 10 [logloss=0.3266 auc=0.8439 train_loss_0=0.3060]
[2023-08-25 10:59:26] INFO Train time: 42.66594s. Valid time: 4.97824s. GPU RAM: 0.04/39.39 GB
[2023-08-25 10:59:26] INFO auc improved. Best value: 0.8439
[2023-08-25 10:59:26] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 11:00:15] INFO Training: Epoch= 11 [logloss=0.3276 auc=0.8435 train_loss_0=0.3043]
[2023-08-25 11:00:15] INFO Train time: 42.98076s. Valid time: 5.52561s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:01:00] INFO Training: Epoch= 12 [logloss=0.3290 auc=0.8431 train_loss_0=0.3027]
[2023-08-25 11:01:00] INFO Train time: 40.70295s. Valid time: 4.53638s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:01:47] INFO Training: Epoch= 13 [logloss=0.3296 auc=0.8426 train_loss_0=0.3014]
[2023-08-25 11:01:48] INFO Train time: 41.00774s. Valid time: 6.37734s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:02:36] INFO Training: Epoch= 14 [logloss=0.3290 auc=0.8435 train_loss_0=0.2997]
[2023-08-25 11:02:36] INFO Train time: 41.85009s. Valid time: 6.74980s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:03:25] INFO Training: Epoch= 15 [logloss=0.3304 auc=0.8437 train_loss_0=0.2984]
[2023-08-25 11:03:25] INFO Train time: 42.20423s. Valid time: 6.48368s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:04:14] INFO Training: Epoch= 16 [logloss=0.3288 auc=0.8439 train_loss_0=0.2968]
[2023-08-25 11:04:15] INFO Train time: 44.03448s. Valid time: 5.40746s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:04:15] INFO auc improved. Best value: 0.8439
[2023-08-25 11:04:15] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 11:04:58] INFO Training: Epoch= 17 [logloss=0.3302 auc=0.8434 train_loss_0=0.2954]
[2023-08-25 11:04:58] INFO Train time: 40.03406s. Valid time: 3.03983s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:05:18] INFO Training: Epoch= 18 [logloss=0.3311 auc=0.8433 train_loss_0=0.2941]
[2023-08-25 11:05:18] INFO Train time: 18.08558s. Valid time: 2.17851s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:06:06] INFO Training: Epoch= 19 [logloss=0.3334 auc=0.8428 train_loss_0=0.2927]
[2023-08-25 11:06:06] INFO Train time: 43.20495s. Valid time: 4.41492s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:06:55] INFO Training: Epoch= 20 [logloss=0.3354 auc=0.8424 train_loss_0=0.2913]
[2023-08-25 11:06:55] INFO Train time: 42.70885s. Valid time: 6.72935s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:07:46] INFO Training: Epoch= 21 [logloss=0.3329 auc=0.8423 train_loss_0=0.2897]
[2023-08-25 11:07:46] INFO Train time: 44.72296s. Valid time: 6.39597s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:08:35] INFO Training: Epoch= 22 [logloss=0.3372 auc=0.8415 train_loss_0=0.2886]
[2023-08-25 11:08:35] INFO Train time: 41.93065s. Valid time: 6.79315s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:09:24] INFO Training: Epoch= 23 [logloss=0.3361 auc=0.8420 train_loss_0=0.2873]
[2023-08-25 11:09:24] INFO Train time: 41.85208s. Valid time: 7.39094s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:10:12] INFO Training: Epoch= 24 [logloss=0.3359 auc=0.8414 train_loss_0=0.2860]
[2023-08-25 11:10:13] INFO Train time: 42.62929s. Valid time: 5.56918s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:10:51] INFO Training: Epoch= 25 [logloss=0.3385 auc=0.8395 train_loss_0=0.2849]
[2023-08-25 11:10:51] INFO Train time: 33.26416s. Valid time: 5.03039s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:11:27] INFO Training: Epoch= 26 [logloss=0.3385 auc=0.8414 train_loss_0=0.2836]
[2023-08-25 11:11:27] INFO Train time: 31.02725s. Valid time: 4.98581s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:11:27] INFO Early stopped. Since the metric auc haven't been improved for 10 epochs.
[2023-08-25 11:11:27] INFO The best score of auc is 0.8439 on epoch 16
[2023-08-25 11:11:27] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-10-50-28-803308.ckpt.
[2023-08-25 11:11:32] INFO Testing:  [logloss=0.3255 auc=0.8464]
