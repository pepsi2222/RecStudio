[2023-08-25 11:05:10] INFO Log saved in /root/autodl-tmp/xingmei/RecStudio/log/AutoInt/ml-1m/2023-08-25-11-05-10-850270.log.
[2023-08-25 11:05:10] INFO Global seed set to 2022
[2023-08-25 11:05:10] INFO dataset is read from ./.recstudio/ml-1m.
[2023-08-25 11:05:20] INFO 
Dataset Info: 

=============================================================================
interaction information: 
field      UserID     MovieID    Rating     Timestamp  
type       token      token      float      float      
##         6041       3417       -          -          
=============================================================================
user information: 
field      UserID     Gender     Age        Occupation Zip-code   
type       token      token      token      token      token      
##         6041       3          8          22         3440       
=============================================================================
item information: 
field      MovieID    Title      Genres     
type       token      token_seq  token_seq  
##         3417       4702       19         
=============================================================================
Total Interactions: 999611
Sparsity: 0.951552
=============================================================================

[2023-08-25 11:05:20] INFO 
Model Config: 

data:
	binarized_rating_thres=3.0
	fm_eval=False
	neg_count=0
	sampler=None
	shuffle=True
	split_mode=user_entry
	split_ratio=[0.8, 0.1, 0.1]
	fmeval=True
	low_rating_thres=0.0
eval:
	batch_size=128
	cutoff=[5, 10, 20]
	val_metrics=['auc', 'logloss']
	val_n_epoch=1
	test_metrics=['auc', 'logloss']
	topk=100
	save_path=./saved/
model:
	embed_dim=10
	item_bias=False
	wide=False
	deep=False
	mlp_layer=[128, 64]
	activation=relu
	dropout=0.5
	attention_dim=10
	num_attention_layers=4
	n_head=1
	residual=True
	residual_project=True
	layer_norm=False
train:
	accelerator=gpu
	ann=None
	batch_size=512
	early_stop_mode=max
	early_stop_patience=10
	epochs=1000
	gpu=1
	grad_clip_norm=None
	init_method=xavier_normal
	item_batch_size=1024
	learner=adam
	learning_rate=0.001
	num_threads=10
	sampling_method=none
	sampler=uniform
	negative_count=0
	excluding_hist=False
	scheduler=None
	seed=2022
	weight_decay=0.0
	tensorboard_path=None
[2023-08-25 11:05:20] INFO Tensorboard log saved in ./tensorboard/AutoInt/ml-1m/2023-08-25-11-05-10-850270.
[2023-08-25 11:05:20] WARNING If you want to use all fields, the float fields might need a scaler. This can be set in dataset.yaml
[2023-08-25 11:05:20] WARNING No retriever is used, topk metrics is not supported.
[2023-08-25 11:05:20] INFO save_dir:./saved/
[2023-08-25 11:05:20] INFO AutoInt(
  (loss_fn): BCEWithLogitLoss()
  (embedding): Embeddings(
    num_features=9, embed_dim=10, reduction=mean
    (embeddings): ModuleDict(
      (Title): Embedding(4702, 10, padding_idx=0)
      (Zip-code): Embedding(3440, 10, padding_idx=0)
      (MovieID): Embedding(3417, 10, padding_idx=0)
      (Gender): Embedding(3, 10, padding_idx=0)
      (Genres): Embedding(19, 10, padding_idx=0)
      (Timestamp): DenseEmbedding(
        embedding_dim=10, bias=False, batch_norm=True
        (batch_norm_layer): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
        (weight): Linear(in_features=1, out_features=10, bias=False)
      )
      (Age): Embedding(8, 10, padding_idx=0)
      (UserID): Embedding(6041, 10, padding_idx=0)
      (Occupation): Embedding(22, 10, padding_idx=0)
    )
    (seq_pooling_layer): SeqPoolingLayer(pooling_type=mean, keepdim=False)
  )
  (int): Sequential(
    (0): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=1, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
    (1): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=1, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
    (2): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=1, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
    (3): SelfAttentionInteractingLayer(
      attention_dim=10, n_head=1, dropout=0.5, residual=True, layer_norm=False
      (attn): AttentionLayer(
        (attn_layer): MultiheadAttention(
          (out_proj): NonDynamicallyQuantizableLinear(in_features=10, out_features=10, bias=True)
        )
      )
      (res): Linear(in_features=10, out_features=10, bias=True)
    )
  )
  (fc): Linear(in_features=90, out_features=1, bias=True)
)
[2023-08-25 11:06:04] INFO Training: Epoch=  0 [logloss=0.3408 auc=0.8250 train_loss_0=0.3668]
[2023-08-25 11:06:04] INFO Train time: 37.94082s. Valid time: 5.23574s. GPU RAM: 0.03/39.39 GB
[2023-08-25 11:06:04] INFO auc improved. Best value: 0.8250
[2023-08-25 11:06:04] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:06:50] INFO Training: Epoch=  1 [logloss=0.3385 auc=0.8276 train_loss_0=0.3376]
[2023-08-25 11:06:50] INFO Train time: 41.14913s. Valid time: 4.66640s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:06:50] INFO auc improved. Best value: 0.8276
[2023-08-25 11:06:50] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:07:37] INFO Training: Epoch=  2 [logloss=0.3366 auc=0.8302 train_loss_0=0.3339]
[2023-08-25 11:07:37] INFO Train time: 42.10922s. Valid time: 5.04784s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:07:37] INFO auc improved. Best value: 0.8302
[2023-08-25 11:07:37] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:08:23] INFO Training: Epoch=  3 [logloss=0.3338 auc=0.8339 train_loss_0=0.3297]
[2023-08-25 11:08:23] INFO Train time: 40.53467s. Valid time: 5.53782s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:08:23] INFO auc improved. Best value: 0.8339
[2023-08-25 11:08:23] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:09:09] INFO Training: Epoch=  4 [logloss=0.3311 auc=0.8365 train_loss_0=0.3248]
[2023-08-25 11:09:09] INFO Train time: 39.23360s. Valid time: 5.94752s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:09:09] INFO auc improved. Best value: 0.8365
[2023-08-25 11:09:09] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:09:51] INFO Training: Epoch=  5 [logloss=0.3298 auc=0.8387 train_loss_0=0.3215]
[2023-08-25 11:09:51] INFO Train time: 36.67314s. Valid time: 5.93497s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:09:51] INFO auc improved. Best value: 0.8387
[2023-08-25 11:09:51] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:10:34] INFO Training: Epoch=  6 [logloss=0.3313 auc=0.8398 train_loss_0=0.3189]
[2023-08-25 11:10:34] INFO Train time: 37.97080s. Valid time: 4.75508s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:10:34] INFO auc improved. Best value: 0.8398
[2023-08-25 11:10:34] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:11:07] INFO Training: Epoch=  7 [logloss=0.3300 auc=0.8411 train_loss_0=0.3167]
[2023-08-25 11:11:07] INFO Train time: 28.30240s. Valid time: 4.49589s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:11:07] INFO auc improved. Best value: 0.8411
[2023-08-25 11:11:07] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:11:35] INFO Training: Epoch=  8 [logloss=0.3287 auc=0.8420 train_loss_0=0.3150]
[2023-08-25 11:11:35] INFO Train time: 25.81914s. Valid time: 2.03709s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:11:35] INFO auc improved. Best value: 0.8420
[2023-08-25 11:11:35] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:11:52] INFO Training: Epoch=  9 [logloss=0.3298 auc=0.8413 train_loss_0=0.3132]
[2023-08-25 11:11:52] INFO Train time: 15.41470s. Valid time: 2.13432s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:12:09] INFO Training: Epoch= 10 [logloss=0.3277 auc=0.8425 train_loss_0=0.3115]
[2023-08-25 11:12:09] INFO Train time: 15.20819s. Valid time: 1.98881s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:12:09] INFO auc improved. Best value: 0.8425
[2023-08-25 11:12:09] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:12:27] INFO Training: Epoch= 11 [logloss=0.3276 auc=0.8427 train_loss_0=0.3098]
[2023-08-25 11:12:27] INFO Train time: 15.27195s. Valid time: 2.19800s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:12:27] INFO auc improved. Best value: 0.8427
[2023-08-25 11:12:27] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:12:44] INFO Training: Epoch= 12 [logloss=0.3288 auc=0.8428 train_loss_0=0.3082]
[2023-08-25 11:12:44] INFO Train time: 15.37545s. Valid time: 2.00855s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:12:44] INFO auc improved. Best value: 0.8428
[2023-08-25 11:12:44] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:13:02] INFO Training: Epoch= 13 [logloss=0.3283 auc=0.8437 train_loss_0=0.3068]
[2023-08-25 11:13:02] INFO Train time: 15.60647s. Valid time: 2.01437s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:13:02] INFO auc improved. Best value: 0.8437
[2023-08-25 11:13:02] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:13:19] INFO Training: Epoch= 14 [logloss=0.3281 auc=0.8437 train_loss_0=0.3055]
[2023-08-25 11:13:19] INFO Train time: 15.17168s. Valid time: 2.01286s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:13:37] INFO Training: Epoch= 15 [logloss=0.3290 auc=0.8442 train_loss_0=0.3043]
[2023-08-25 11:13:37] INFO Train time: 15.33476s. Valid time: 2.06252s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:13:37] INFO auc improved. Best value: 0.8442
[2023-08-25 11:13:37] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:13:54] INFO Training: Epoch= 16 [logloss=0.3283 auc=0.8439 train_loss_0=0.3030]
[2023-08-25 11:13:54] INFO Train time: 15.11482s. Valid time: 2.01832s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:14:10] INFO Training: Epoch= 17 [logloss=0.3289 auc=0.8426 train_loss_0=0.3020]
[2023-08-25 11:14:10] INFO Train time: 14.51827s. Valid time: 2.00712s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:14:27] INFO Training: Epoch= 18 [logloss=0.3285 auc=0.8440 train_loss_0=0.3011]
[2023-08-25 11:14:27] INFO Train time: 14.36131s. Valid time: 2.09485s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:14:43] INFO Training: Epoch= 19 [logloss=0.3317 auc=0.8433 train_loss_0=0.2999]
[2023-08-25 11:14:43] INFO Train time: 14.45316s. Valid time: 2.00767s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:15:03] INFO Training: Epoch= 20 [logloss=0.3293 auc=0.8444 train_loss_0=0.2987]
[2023-08-25 11:15:03] INFO Train time: 17.45480s. Valid time: 2.10180s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:15:03] INFO auc improved. Best value: 0.8444
[2023-08-25 11:15:03] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:15:20] INFO Training: Epoch= 21 [logloss=0.3299 auc=0.8433 train_loss_0=0.2973]
[2023-08-25 11:15:20] INFO Train time: 14.83434s. Valid time: 2.00360s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:15:37] INFO Training: Epoch= 22 [logloss=0.3318 auc=0.8438 train_loss_0=0.2962]
[2023-08-25 11:15:37] INFO Train time: 14.52569s. Valid time: 2.08053s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:15:54] INFO Training: Epoch= 23 [logloss=0.3298 auc=0.8440 train_loss_0=0.2953]
[2023-08-25 11:15:54] INFO Train time: 14.77980s. Valid time: 2.16766s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:16:10] INFO Training: Epoch= 24 [logloss=0.3309 auc=0.8433 train_loss_0=0.2941]
[2023-08-25 11:16:10] INFO Train time: 14.16371s. Valid time: 1.99675s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:16:26] INFO Training: Epoch= 25 [logloss=0.3345 auc=0.8411 train_loss_0=0.2931]
[2023-08-25 11:16:26] INFO Train time: 14.19922s. Valid time: 2.17139s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:16:43] INFO Training: Epoch= 26 [logloss=0.3321 auc=0.8438 train_loss_0=0.2920]
[2023-08-25 11:16:43] INFO Train time: 14.24108s. Valid time: 1.99286s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:16:59] INFO Training: Epoch= 27 [logloss=0.3320 auc=0.8425 train_loss_0=0.2907]
[2023-08-25 11:16:59] INFO Train time: 14.12606s. Valid time: 1.96568s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:17:15] INFO Training: Epoch= 28 [logloss=0.3327 auc=0.8429 train_loss_0=0.2895]
[2023-08-25 11:17:15] INFO Train time: 14.04888s. Valid time: 2.21242s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:17:31] INFO Training: Epoch= 29 [logloss=0.3334 auc=0.8426 train_loss_0=0.2888]
[2023-08-25 11:17:31] INFO Train time: 14.52119s. Valid time: 2.06705s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:17:48] INFO Training: Epoch= 30 [logloss=0.3362 auc=0.8411 train_loss_0=0.2877]
[2023-08-25 11:17:48] INFO Train time: 14.26879s. Valid time: 1.97842s. GPU RAM: 0.04/39.39 GB
[2023-08-25 11:17:48] INFO Early stopped. Since the metric auc haven't been improved for 10 epochs.
[2023-08-25 11:17:48] INFO The best score of auc is 0.8444 on epoch 20
[2023-08-25 11:17:48] INFO Best model checkpoint saved in ./saved/AutoInt/ml-1m/2023-08-25-11-05-10-850270.ckpt.
[2023-08-25 11:17:50] INFO Testing:  [logloss=0.3272 auc=0.8459]
